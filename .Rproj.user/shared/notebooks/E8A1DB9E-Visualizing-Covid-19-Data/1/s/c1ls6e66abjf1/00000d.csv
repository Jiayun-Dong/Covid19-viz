"0","# the US trajectory of cases"
"0","  overview = dat %>%"
"0","    group_by(date) %>%"
"0","    summarise_if(is.numeric, sum, na.rm=TRUE) %>% # aggregate numeriac variables at national level"
"0","    mutate(positiveDailyIncrease = positive - lag(positive),"
"0","           testResultsDailyIncrease = totalTestResults - lag(totalTestResults),"
"0","           positiveDailyIncrease = replace_na(positiveDailyIncrease, 0), # the first day has no lag: set as zero"
"0","           testResultsDailyIncrease = replace_na(testResultsDailyIncrease, 0),"
"0","           positiveRate = positive / totalTestResults,"
"0","           day = row_number())"
"0",""
"0","  # projection assuming same growth rate"
"0","    xmax = max(overview$day)"
"0","    ymax = max(overview$positive)"
"0","    y = overview$positive[(xmax - 7) : (xmax - 3)]"
"0","    x = overview$day[(xmax - 7) : (xmax - 3)]"
"0","    f = lm(log(y) ~ x)$coefficients"
"0","    l = function(x) exp(f[1] + f[2] * x)"
"0","    projection <- data.frame(x = (xmax - 7) : xmax, y = NA)"
"0","    projection$y <- l(projection$x)"
"0","  "
"0","  # time series of positive cases "
"0","  ggplot(data = overview, aes(x = day)) +"
"0","    geom_line(aes(y = positive, color = ""Positive Cases"")) +"
"0","    geom_bar(stat = ""identity"", aes(y = positiveDailyIncrease, fill = ""Daily Increase in Positive Cases"")) +"
"0","    geom_line(data = projection, aes(x = x, y = y, color = ""Projected Trajectory""), linetype = ""dashed"", show.legend=FALSE) +"
"0","    scale_x_continuous(breaks = seq(1,xmax, 5), labels = overview$date[seq(1,xmax, 5)]) +"
"0","    scale_y_continuous(labels = scales::comma) +"
"0","    scale_color_manual(values = c(""darkred"", ""grey"")) +"
"0","    scale_fill_manual(values = ""darkblue"") +"
"0","    theme_minimal() +"
"0","    theme(legend.position = ""bottom"", legend.title = element_blank(), "
"0","          axis.title.x = element_blank(), axis.title.y = element_blank()) +"
"0","    ggtitle(""Overview of Covid-19 in the US: Positive Cases"")"
